@model IEnumerable<Salon.Views.ViewModels.WorkPerClassViewModel>

<link href="~/Content/bootstrap.css" rel="stylesheet" type="text/css" media="screen" runat="server" />

@{
	ViewBag.Title = "Work per student";
}

<h2>Arbeit nach Klasse</h2>

<div style="margin: 30px 0px 30px 0px; display: inline-block; width: 100%">
	<text style="width: 160px; display: inline-block">Klasse</text>
    <text style="display: inline-block">Sortieren nach</text>
    <br />
    <select class="form-control" style="width: 150px; height:40px; display: inline-block" id="classSelector">
		@foreach(var item in Model.First().GetClasses())
		{
			<option>@item</option>
		}
	</select>
    <select class="form-control" style="width: 180px; height:40px; display: inline-block; margin-left: 10px;" id="sortSelector">
        <option>Datum aufsteigend</option>
        <option>Datum absteigend</option>
        <option>Name aufsteigend</option>
        <option>Name absteigend</option>
    </select>

    @Html.DropDownListFor(n => Model.First().SelectedTeacher, Model.First().GetTeachers(), "--Select a teacher--") 
    @*https://forums.asp.net/t/2106150.aspx?HTML+DropDownList+Key+and+Value+for+options*@

    
    <button style="margin-left: 10px; width: 150px; height: 40px; display: inline-block; clear: both" class="btn btn-primary" onclick="changeClass();">Anzeigen</button>
    <button style="float: right; display: inline-block; width: 150px; height: 40px" class="btn btn-primary" onclick="location.href='@Url.Action("WorkPerClassExport", "Reports", new {})'">Download &#x21e9</button>
</div>

@if (ViewBag.Downloaded == true)
{
    if (ViewBag.Success == true)
    {
	    <script type="text/javascript">
	    		window.onload = function () {
	    		    alert("Die Datei wurde erfolgreich heruntergeladen!");
	    		};
	    </script>
    }
    else
    {
        string message = "Die Datei konnte nicht heruntergeladen werden!\r\n" + ViewBag.Message;
    }
}

<div id="workTable" style="display: none; overflow: auto; height: 40%">
	
</div>

<script>
	function changeClass() {
		$.ajax({
		    url: "/reports/workperclass?cl=" + $("#classSelector").val() + "&sort=" + $("#sortSelector").val(),
			type: "get",
			success: function (result) {
				$("#workTable").html(result);
				$("#workTable").show();
			}
		});
	}
</script>