@model IEnumerable<Salon.Views.ViewModels.WorkPerClassViewModel>

<link href="~/Content/bootstrap.css" rel="stylesheet" type="text/css" media="screen" runat="server" />

@{
	ViewBag.Title = "Work per student";
}

<h2>Arbeit nach Klasse</h2>

<div id="header" style="margin-top: 20px;">    
    <button style="display: inline-block; width: 150px; height: 40px;" type="button" class="btn btn-primary" data-toggle="collapse" data-target="#filter">Filter</button> @*Filter button, that collapses the div beyond*@
    <button style="margin-left: 10px; width: 150px; height: 40px; display: inline-block; clear: both" class="btn btn-primary" onclick="changeClass();">Anzeigen</button> @*Show data*@
    <button style="float: right; display: inline-block; width: 150px; height: 40px;" class="btn btn-primary" onclick="location.href='@Url.Action("WorkPerClassExport", "Reports", new {})'">Download &#x21e9</button> @*Download button*@
</div>
<div id="filter" class="collapse"> @*div that collapses on button click*@
    <div style="margin: 20px 0px 0px 0px; display: inline-block; width: 80%">
        <text style="width: 160px; display: inline-block">Klasse</text>
        <text style="width: 160px; display: inline-block">Lehrer</text>
        <text style="width: 160px; display: inline-block">Raum</text>
        <text style="display:inline-block">Sortieren nach</text>
        <br />
        <select class="form-control" style="width: 150px; height:40px; display: inline-block" id="classSelector"> @*Selector Class*@
            @foreach (var item in Model.First().GetClasses())
            {
                <option>@item</option>
            }
        </select>

        <select class="form-control" style="width: 150px; height:40px; display: inline-block; margin-left: 10px;" id="teacherSelector"> @*Selector Teacher*@
            @foreach (var item in Model.First().GetTeachers())
            {
                <option>@item.Text</option>}
        </select>

        <select class="form-control" style="width: 150px; height:40px; display: inline-block; margin-left: 10px;" id="roomSelector"> @*Selector Room*@
            @foreach (var item in Model.First().GetRooms())
            {
                <option>@item.Text</option>}
        </select>

        <select class="form-control" style="width: 180px; height:40px; display: inline-block; margin-left: 10px;" id="sortSelector"> @*Selector Sortoptions*@
            <option>Datum aufsteigend</option>
            <option>Datum absteigend</option>
            <option>Schüler aufsteigend</option>
            <option>Schüler absteigend</option>
        </select>
    </div>
</div>

<div id="workTable" style="display: none; overflow: auto; height: 40%; margin-top: 20px;"> @*Placeholder*@

</div>

@*Shows if the download was succesfull*@
@if (ViewBag.Downloaded == true) 
{
    if (ViewBag.Success == true)
    {
	    <script type="text/javascript">
	    		window.onload = function () {
	    		    alert("Die Datei wurde erfolgreich heruntergeladen!");
	    		};
	    </script>
    }
    else
    {
        string message = "Die Datei konnte nicht heruntergeladen werden!\r\n" + ViewBag.Message;
    }
}

<script>
	function changeClass() {
		$.ajax({
		    url: "/reports/workperclass?cl=" + $("#classSelector").val() + "&sort=" + $("#sortSelector").val() + "&teacher=" + $("#teacherSelector").val() + "&room=" + $("#roomSelector").val(),
			type: "get",
			success: function (result) {
				$("#workTable").html(result);
				$("#workTable").show();
			}
		}); @*Calls method in controller and passes the parameters*@
	}
</script>